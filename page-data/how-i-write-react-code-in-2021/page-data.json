{"componentChunkName":"component---src-templates-blog-post-js","path":"/how-i-write-react-code-in-2021/","webpackCompilationHash":"4e1985a14b92e7367e74","result":{"data":{"site":{"siteMetadata":{"title":":heart: React","author":"Metamn"}},"markdownRemark":{"id":"6b65bff5-473a-56be-8186-2f8afbc62eac","excerpt":"I optimize for less cognitive load.","html":"<p>I optimize for less cognitive load.</p>\n<!--more-->\n<hr>\n<p>Unlike its counterparts — Elm, Ruby on Rails, re:frame of ClojureScript — React is a less-opinionated framework.</p>\n<p>It leaves what to optimize for on the developer. I choose simplicity, as little cognitive load as possible.</p>\n<p>React is a glue. Sits in the middle, between the user interface and the back-end, connecting multiple domains.</p>\n<p>When React becomes a second nature it leaves room for acquiring expertise in the connected domains. It’s better to focus on the domains than getting stuck with a framework connecting them.</p>\n<p><a href=\"https://web.dev/new-responsive/?utm_source=CSS-Weekly&#x26;utm_campaign=Issue-461&#x26;utm_medium=email\">Responsive web design</a>, <a href=\"https://maxkoehler.com/posts/continuous-typography/\">screen typography</a>, HTML and CSS is changing after a decade of stagnation; creating scalable design systems and component libraries is a <a href=\"http://metamn.io/react/on-design-sytems/\">challenge</a>; event-driven architectures, reactive and functional programming are skills to learn.</p>\n<p>On the other hand, optimizing for a goal helps decision making.</p>\n<p>Coding is decision making. When the goal is clear, making decisions is easy.</p>\n<h2>Less cognitive load</h2>\n<p>It sounds vague but reducing cognitive load is possible, desirable at every phase in React development.</p>\n<p>Creating a new component? Use a generator. No need to remember component structure and to write boilerplate code.</p>\n<p>Importing a component? Use module path aliases. No need to remember project folder structure.</p>\n<p>Defining function signature? Use a single composite prop. Then deal with the details later. No need to worry prematurely about data structures.</p>\n<p>Writing logic? Use a general abstraction to tackle every problem in the same way.</p>\n<p>Too much code inside a file? Split into atomic, standalone, small units responsible for a single aspect of the problem. Focus on a single aspect at once, iterate all aspects, then compose up the final result.</p>\n<p>Sparing attention with little tricks add up. The less attention needed for non-creative code the more attention stays available for writing <em>real</em> code.</p>\n<h2>Generators</h2>\n<p>To make code look uniform I use generators.</p>\n<p>Instead of manually creating project files, folders — and writing boilerplate code — I generate them.</p>\n<p>For VSCode I use <a href=\"https://github.com/Huuums/vscode-folder-templates\">VSCode Folder Templates</a>. In a project where team members use different editors we go for a command line generator like <a href=\"https://github.com/osequi/new-component\">New Component</a>.</p>\n<p>The generator generates all files a component needs: the main component file, test and documentation files, style and data declarations, or anything else specific to the project.</p>\n<p>Inside every file the generator generates boilerplate code. The final result is uniform, and is ready in seconds vs. minutes when code and structure duplicates by hand.</p>\n<p>A simple component generator example:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// [FTName].tsx</span>\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> TComponent<span class=\"token punctuation\">,</span> component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@components\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> edoStyle <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@tokens\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> defaultsDeep <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"lodash\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">T</span><span class=\"token punctuation\">[</span>FTName<span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TComponent</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">null</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>FTName <span class=\"token operator\">|</span> lowerCase<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span>FTName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>component\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">[</span>FTName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span>FTName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> props2 <span class=\"token operator\">=</span> <span class=\"token function\">defaultsDeep</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>FTName <span class=\"token operator\">|</span> lowerCase<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>className<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props2<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> style <span class=\"token operator\">=</span> <span class=\"token function\">edoStyle</span><span class=\"token punctuation\">(</span>className<span class=\"token punctuation\">,</span> <span class=\"token string\">\"[FTName]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>p <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>style<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">[</span>FTName<span class=\"token punctuation\">]</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// index.ts</span>\n<span class=\"token keyword\">export</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./[FTName]'</span></code></pre></div>\n<p>After generating a <code class=\"language-text\">Button</code> component the result becomes:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Button.tsx</span>\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> TComponent<span class=\"token punctuation\">,</span> component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@components'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> edoStyle <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@tokens'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> defaultsDeep <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'lodash'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">TButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TComponent</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">null</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> button<span class=\"token punctuation\">:</span> TButton <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>component<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Button</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">:</span> TButton</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> props2 <span class=\"token operator\">=</span> <span class=\"token function\">defaultsDeep</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>props <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> button<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> className <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props2\n\n  <span class=\"token keyword\">const</span> style <span class=\"token operator\">=</span> <span class=\"token function\">edoStyle</span><span class=\"token punctuation\">(</span>className<span class=\"token punctuation\">,</span> <span class=\"token string\">'Button'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>p <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>style<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Button<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// index.ts</span>\n<span class=\"token keyword\">export</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./Button'</span></code></pre></div>\n<h2>Component structure</h2>\n<p>To make component code better understandable, to enable a common structure, I use logical units.</p>\n<p>Every component is built on three sections:</p>\n<ul>\n<li>Imports</li>\n<li>Type and data definitions</li>\n<li>Component logic</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Button.tsx</span>\n\n<span class=\"token comment\">/**\n * Imports\n */</span>\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> TComponent<span class=\"token punctuation\">,</span> component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@components'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> edoStyle <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@tokens'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> defaultsDeep <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'lodash'</span>\n\n<span class=\"token comment\">/**\n * Type and data definitions\n */</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">TButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TComponent</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">null</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> button<span class=\"token punctuation\">:</span> TButton <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>component<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> buttonQuery <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token comment\">// GraphQL</span>\n\n<span class=\"token comment\">/**\n * Component logic\n */</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Button</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">:</span> TButton</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> props2 <span class=\"token operator\">=</span> <span class=\"token function\">defaultsDeep</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>props <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> button<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> className <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props2\n\n  <span class=\"token keyword\">const</span> style <span class=\"token operator\">=</span> <span class=\"token function\">edoStyle</span><span class=\"token punctuation\">(</span>className<span class=\"token punctuation\">,</span> <span class=\"token string\">'Button'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>p <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>style<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Button<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Imports</h2>\n<p><a href=\"https://nextjs.org/docs/advanced-features/module-path-aliases\">Absolute imports and module path aliases</a> is a Typescript feature making project imports better comprehensible and easier to write.</p>\n<p>In <code class=\"language-text\">tsconfig.json</code> one can set up aliases, <code class=\"language-text\">paths</code> pointing to common folders in the project.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"paths\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"@data\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"data/\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"@apps/*\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"apps/*\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"@components\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"components\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"@tokens\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"tokens/\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Then in components, project-related <code class=\"language-text\">imports</code> use these aliases vs. figuring out relative paths.</p>\n<p><code class=\"language-text\">import { edoStyle } from &#39;@tokens&#39;</code> is easier to remember than <code class=\"language-text\">import { edoStyle } from &#39;../../design-system/tokens&#39;</code>.</p>\n<h2>Type and data definitions</h2>\n<p>Programming is about transformation. The problem comes in, it gets solved, and the solution goes out.</p>\n<p>The problem comes in as data. To describe it I use PropTypes, TypeScript and optionally, when the data comes from an API, GraphQL or JSON.</p>\n<p>In any case I use type definitions.</p>\n<p>Even when the data comes from the API.\nAt first it seems definition duplication but the scope differs.</p>\n<p>Type definitions assure the transformations (the functions) won’t break.\nData definitions assure the front-end is in sync with the back-end.</p>\n<p>When no data comes from the API, type definitions help to lay out a front-end API.</p>\n<p>Yes, the front-end needs an API too. Otherwise how do you build a design system, or component library, with dozens of components and another dozen tokens with no back-end dictating a data structure?</p>\n<h3>Single-responsibility Principle</h3>\n<p>In addition, type definitions make sure the component is minimal in scope, following the <a href=\"https://en.wikipedia.org/wiki/Single-responsibility_principle\">Single-responsibility Principle</a>.</p>\n<p>More than one type definition inside a component is a code smell. It means the component should split. It does more than a well-defined singular task.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// This is a code smell.</span>\n<span class=\"token comment\">// `project`, `projects` should merge into a single interface.</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">TProjectSlugPage</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TComponent</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">null</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n  seo<span class=\"token punctuation\">:</span> TSeo<span class=\"token punctuation\">;</span>\n  project<span class=\"token punctuation\">:</span> TProjects<span class=\"token punctuation\">;</span>\n  error<span class=\"token punctuation\">:</span> TError<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">TProjectList</span> <span class=\"token punctuation\">{</span>\n  projects<span class=\"token punctuation\">:</span> TProjects<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Default values and function signatures</h2>\n<p>There are ways to define component props and associate default values to them.</p>\n<p>A common approach is to destructure props in the function signature. Another approach is to destructure them in the function body.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Destructuring in function signature</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Video</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>prop1<span class=\"token punctuation\">,</span> prop2<span class=\"token punctuation\">}</span><span class=\"token punctuation\">:</span> TVideo</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Destructuring in function body</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Video</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">:</span> TVideo</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>prop1<span class=\"token punctuation\">,</span> prop2<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Associating default props comes with at least three different approaches.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Associating default props in function signature</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Video</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>prop1<span class=\"token punctuation\">,</span> prop2<span class=\"token punctuation\">}</span><span class=\"token punctuation\">:</span> TVideo <span class=\"token operator\">=</span> video</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Associating default props in function signature at destructuring</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Video</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>prop1<span class=\"token punctuation\">:</span> <span class=\"token string\">'prop1'</span><span class=\"token punctuation\">,</span> prop2<span class=\"token punctuation\">:</span> <span class=\"token string\">'prop2'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">:</span> TVideo<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Associating default props in function body</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Video</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">:</span> TVideo</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>prop1<span class=\"token punctuation\">,</span> prop2<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">,</span> video<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Which approach is better? Which approach is complete? What makes an approach better than another?</p>\n<p>A <a href=\"http://metamn.io/react/on-function-signatures/\">quick analysis</a> shows where to destructure props, and assign default values to them depends on the shape of the props.</p>\n<p>When props are a flat object and small in number, destructuring in function signature + assigning default values at destructuring, wins. In a capable editor <code class=\"language-text\">ctrl+hover</code> over the function name displays good enough usage information.</p>\n<p>Nested props require a special deep merging function to associate with the default props. This implies destructuring in the function body.</p>\n<p>The developer experience with <code class=\"language-text\">ctrl+hover</code> over the function name is less pleasant: the default values, helping to infer the prop type, are not shown.</p>\n<p>A practice to follow should be:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Props are flat and small in number.</span>\n<span class=\"token comment\">// This approach is recommended.</span>\n<span class=\"token comment\">//</span>\n<span class=\"token comment\">// This approach gives the best developer experience:</span>\n<span class=\"token comment\">// On `ctrl+hover` the type of the props can be inferred from their default value.</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Video</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>prop1 <span class=\"token operator\">=</span> <span class=\"token string\">'prop1'</span><span class=\"token punctuation\">,</span> prop2 <span class=\"token operator\">=</span> <span class=\"token string\">'prop2'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">:</span> TVideo<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Props are flat but large in number.</span>\n<span class=\"token comment\">// This approach is not recommended.</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Video</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  prop1 <span class=\"token operator\">=</span> <span class=\"token string\">'prop1'</span><span class=\"token punctuation\">,</span>\n  prop2 <span class=\"token operator\">=</span> <span class=\"token string\">'prop2'</span><span class=\"token punctuation\">,</span>\n  prop3 <span class=\"token operator\">=</span> <span class=\"token string\">'prop3'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">...</span>\n  <span class=\"token operator\">...</span>\n  prop10 <span class=\"token operator\">=</span> <span class=\"token string\">'prop10'</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">:</span> TVideo<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Props are flat but large in number.</span>\n<span class=\"token comment\">// This approach is recommended for better code readability.</span>\n<span class=\"token comment\">//</span>\n<span class=\"token comment\">// On `ctrl+hover` this approach doesn't give hints about the type of the props.</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Video</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">:</span> TVideo</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> propsMerged <span class=\"token operator\">=</span> <span class=\"token function\">defaultsDeep</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>props <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> defaultProps<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> prop1<span class=\"token punctuation\">,</span> prop2 <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> propsMerged\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Props are nested.</span>\n<span class=\"token comment\">// This approach is recommended (perhaps the only viable option).</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Video</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">:</span> TVideo</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> propsMerged <span class=\"token operator\">=</span> <span class=\"token function\">defaultsDeep</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>props <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> defaultProps<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> prop1<span class=\"token punctuation\">,</span> prop2 <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> propsMerged\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Functional abstraction</h2>\n<p>React plays the <a href=\"http://metamn.io/react/the-reactive-fuctional-nature-of-react/\">functional and reactive</a> game.</p>\n<p>It borrows often from Clojure/ClojureScript, a language built on a grand abstraction.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 768px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/react/static/a9f159d36bb3398b06c1cd92b2b45c5d/87b15/the-grand-abstraction.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.15657620041753%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAACTElEQVQozz2TaY/aMBCG8/9/0krtfuhK3YtjIYSAYxvft+MQoF87SbaVXo0maB7PSWWCcknbqC04UbtkvpUXa33vfHbg2GT+Cz5N1JXyCjGsgxZWaKdmR3ItuJU2WR2N8sYkG0pYFIcQrzEMAfjKJbs9tS2j1IgDxQfcEclOlMCPR4LrDrWUNKQDoNz7/pbzLeUxpSF6gOGNVELvRDZ8UvH5XvolbpwETn/rwUnAgK4pXKMvAYqvfFCs+WIcc81dNBq3rm2iU3FMkA1Cv5l/ZAR4iC57N8EXRDlmVmDeMcOgpHhB/ZggeZmUwQ6zyi2XqYo8xZQwwe6COkkvkhCJJZR9y14zq1n5UyBogcujlMcw9fLo871P1wgwLAjgcycwU5QIjFnnegfkkHSn+GddAwB19tmWZEq2mZ4z6/KjwNhhx5Wjp6lgzTqGQDa70QkdzPPbhwzGG+4oMoIs0hwreg4cB7gLmLa3HNdbAgOznAiicJu9fPr9drEqaNjS19wRwWAVhRpP9EQYUujgLK98752TnmNQlFTKy4/X9yPF45jgITyTdBY0BTl0UNILOC9H2gpOD7aS79MaoUOTPWI0wVSj1mIiCe+mccx2aQ3RM4Wh0nM1X6+PQ1yU5ksy2QWvGDps290RNU3XNKgBmE4iADPDLT5W0wFNayxlWeyt7+GqxgTzhLcxOkASLDDkV07AeuC/ILy0F+QVrQ6nfd3u9+1uf9yBrY+zTvvdcbfZrV6fnz5efm7r9aZer3er9X612ryvX57Xr78+vj7/AoE+JXxFA/owAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"The Grand Abstraction\"\n        title=\"The Grand Abstraction\"\n        src=\"/react/static/a9f159d36bb3398b06c1cd92b2b45c5d/5cc77/the-grand-abstraction.png\"\n        srcset=\"/react/static/a9f159d36bb3398b06c1cd92b2b45c5d/72cd8/the-grand-abstraction.png 192w,\n/react/static/a9f159d36bb3398b06c1cd92b2b45c5d/45483/the-grand-abstraction.png 384w,\n/react/static/a9f159d36bb3398b06c1cd92b2b45c5d/5cc77/the-grand-abstraction.png 768w,\n/react/static/a9f159d36bb3398b06c1cd92b2b45c5d/04090/the-grand-abstraction.png 1152w,\n/react/static/a9f159d36bb3398b06c1cd92b2b45c5d/87b15/the-grand-abstraction.png 1437w\"\n        sizes=\"(max-width: 768px) 100vw, 768px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n<em>From Alex Miller’s screencast <a href=\"https://youtu.be/qe60zwUAOqE\">Clojure Enemy of the State</a></em></p>\n<p>The idea is to transform initial data into a series of sequences and apply standard code upon the sequences.</p>\n<p>This is how Clojure solves problems. Divides a problem into subproblems — small sequences — and applies standard problem solving techniques on each sequence.</p>\n<p>The key is standard code / standard problem solving technique.</p>\n<p>Clojure offers a vast standard library capable of manipulating all kinds of sequences. The task of a developer reduces to <em>using</em> the library vs. writing her own code. This way the solution is better: approved, used and reused by a community vs the brainchild of a single individual.</p>\n<p>The Clojure way simplifies problem solving to a single task: find the best sequences. The rest is handled by previous wisdom.</p>\n<p>I use the same approach in writing React component functions.</p>\n<p>I start with the data (props), then create sequences from props, where I apply — ideally — standard functions.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Video</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">:</span> TVideo</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/**\n   * Start with the data\n   */</span>\n  <span class=\"token keyword\">const</span> props2 <span class=\"token operator\">=</span> <span class=\"token function\">defaultsDeep</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>props <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> video<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> className<span class=\"token punctuation\">,</span> hosted<span class=\"token punctuation\">,</span> served <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props2\n\n  <span class=\"token comment\">/**\n   * Chopped sequences: `hosted`, `served`\n   * Apply function on sequences\n   */</span>\n  <span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token function\">getVideoUrl</span><span class=\"token punctuation\">(</span>hosted<span class=\"token punctuation\">,</span> served<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>url<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span>\n\n  <span class=\"token comment\">/**\n   * Chopped sequence: `className`\n   * Apply function on sequence\n   */</span>\n  <span class=\"token keyword\">const</span> style <span class=\"token operator\">=</span> <span class=\"token function\">edoStyle</span><span class=\"token punctuation\">(</span>className<span class=\"token punctuation\">,</span> <span class=\"token string\">'Video'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">/**\n   * When all the subproblems are solved ...\n   * ... return the result\n   */</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ReactPlayer</span></span> <span class=\"token attr-name\">url</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>url<span class=\"token punctuation\">}</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">style</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>There’s nothing extraordinary in the code above. It looks natural, and should look natural.</p>\n<p>The advantage shows in time. A standard library grows along the projects offering reliability and faster development time for its users.</p>\n<p>On another hand this technique offers uniform thinking across a team. It reduces the problem solving process to:</p>\n<p><code class=\"language-text\">problem === data -&gt; sequences -&gt; solutions -&gt; composition === solution</code>.</p>\n<h2>Functional style</h2>\n<p>A key approach in functional programming is to create atomic sequences / subproblems and atomic solutions for them.</p>\n<p>An atomic problem / solution is not further reducible. It is pure, it exists in a canonical state.</p>\n<p>Practice shows systems compose up better when the underlying constructs, components are atomic / pure.</p>\n<p>In the example above both <code class=\"language-text\">defaultsDeep</code>, <code class=\"language-text\">getVideoUrl</code>, <code class=\"language-text\">edoStyle</code> and <code class=\"language-text\">ReactPlayer</code> are atomic. They can’t be further reduced. And they return predictable results which compose up nicely.</p>\n<p>If we look deeper, let’s say into the <code class=\"language-text\">getVideoUrl</code> code, we should see pure / atomic code, again.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getVideoUrl</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">hosted<span class=\"token punctuation\">,</span> served</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> string<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|</span> string <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>hosted <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>served<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span>\n  <span class=\"token keyword\">return</span> hosted <span class=\"token operator\">&amp;&amp;</span> hosted<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>videoUrl\n    <span class=\"token operator\">?</span> <span class=\"token function\">getHostedUrl</span><span class=\"token punctuation\">(</span>hosted<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">:</span> <span class=\"token function\">getServedUrl</span><span class=\"token punctuation\">(</span>served<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>And so on.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getHostedUrl</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">hosted</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> string <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> hosted<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>videoUrl\n    <span class=\"token operator\">?</span> <span class=\"token function\">canPlayUrl</span><span class=\"token punctuation\">(</span>hosted<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>videoUrl<span class=\"token punctuation\">)</span>\n      <span class=\"token operator\">?</span> hosted<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>videoUrl\n      <span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span>\n    <span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>I tend to write pure / atomic functions. Not in the strict but the logical sense.</p>\n<h2>Functional programming with Ramda</h2>\n<p><a href=\"https://github.com/MostlyAdequate/mostly-adequate-guide\">Functional programming</a> is not a silver bullet. And it’s hard to learn when one is coming from object-oriented, imperative programming — as the majority of us do.</p>\n<p>Understanding its principles and applying its style is often enough in a React environment. A short learning assures immediate better code.</p>\n<p>I often find myself in front of a problem more complex than mapping and reducing data.\nIn such cases I appeal to <a href=\"https://ramdajs.com/\">Ramda</a>, a functional library for JavaScript.</p>\n<p>Ramda is transparent to React. No matter if you write <code class=\"language-text\">getVideoUrl</code> with Ramda or JavaScript. React can’t sense the difference.</p>\n<p>The difference is in the cognitive load of the developer.</p>\n<p>Writing slightly complex algorithms in the imperative way I found to take a larger toll on my attention and patience than writing the same algorithm with Ramda.</p>\n<p>With Ramda I think more about the problem — in time, in depth — and write less code.</p>\n<p>The end result feels compact. Even if I use only a small subset of the functional programming toolset — immutable data, curried functions, and compositions.</p>\n<h2>Co-location</h2>\n<p>In pursuing simplicity — applying the ‘rules’ above — components decompose into smaller parts.</p>\n<p>Oftentimes they decompose into multiple files. React calls this phenomenon co-location.</p>\n<p>The component folder co-locates files specialized in single tasks: component code, component logic, style, tests, dev notes, specifications and anything else.</p>\n<p>When the developer opens a folder it gets the big picture. What libraries, techniques this project is built on, how complex and complete the component is, where to start the work.</p>\n<p>Then opens a file, reduces the focus, thus the cognitive load, to a single aspect of the problem. And works in peace.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># A sample component folder structure</span>\nVideo.tsx\nVideo.test.tsx\nVideo.functions.ts\nVideo.functions.test.ts\nVideo.style.ts\nVideo.md\n<span class=\"token punctuation\">..</span>.</code></pre></div>\n<h2>Summary</h2>\n<p>Reducing cognitive load should pay off.</p>\n<p>Little things and tricks can spare attention — preserve it for solving the bulk of the problem.</p>\n<p>Hopefully, this approach scales beyond individuals enabling faster and more concise development for teams.</p>\n<p>After all, it is about simplifying structures and models.</p>\n<table>\n<thead>\n\t<tr>\n\t\t<th>Structure, model</th>\n\t\t<th>Simplifying technique</th>\n\t\t<th>Reduces cognitive load on / to</th>\n\t</tr>\n</thead>\n<tbody>\n\t<tr>\n\t\t<td>Folders</td>\n    <td>Generators</td>\n    <td>Boilerplate code</td>\n  </tr>\n  <tr>\n\t\t<td></td>\n    <td>Path aliases</td>\n    <td>Locating of components</td>\n  </tr>\n  <tr>\n\t\t<td></td>\n    <td>Co-location</td>\n    <td>Aspects</td>\n  </tr>\n  <tr>\n\t\t<td>Components</td>\n    <td>Logical sections</td>\n    <td>Locating parts of the component</td>\n  </tr>\n  <tr>\n\t\t<td>Data</td>\n    <td>Always have an API</td>\n    <td>Thinking about correctness</td>\n  </tr>\n  <tr>\n\t\t<td>Main function</td>\n    <td>Simple function signature</td>\n    <td>Thinking prematurely about non-significant aspects</td>\n  </tr>\n  <tr>\n\t\t<td></td>\n    <td>The Grand Abstraction</td>\n    <td>Thinking in sequences, don't worrying about the rest</td>\n  </tr>\n  <tr>\n\t\t<td>Other functions</td>\n    <td>Pure, atomic, Single-responsibility Principle</td>\n    <td>Solve simple problems at once</td>\n  </tr>\n  <tr>\n\t\t<td>Programming</td>\n    <td>Functional, with Ramda</td>\n    <td>Composing up, declaring a solution</td>\n  </tr>\n</tbody>\n</table>\n<h2>Resources</h2>\n<ul>\n<li><a href=\"https://web.dev/new-responsive/\">The new responsive: Web design in a component-driven world</a></li>\n<li><a href=\"https://maxkoehler.com/posts/continuous-typography/\">Continuous Typography</a></li>\n<li><a href=\"http://metamn.io/react/on-design-sytems/\">On design systems</a></li>\n<li><a href=\"https://github.com/Huuums/vscode-folder-templates\">VSCode Folder Templates</a></li>\n<li><a href=\"https://github.com/osequi/new-component\">New Component</a></li>\n<li><a href=\"https://nextjs.org/docs/advanced-features/module-path-aliases\">Absolute Imports and Module path aliases</a></li>\n<li><a href=\"http://metamn.io/react/on-function-signatures/\">On function signatures</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Single-responsibility_principle\">Single-responsibility Principle</a></li>\n<li><a href=\"http://metamn.io/react/the-reactive-fuctional-nature-of-react/\">The reactive, functional nature of React</a></li>\n<li><a href=\"https://youtu.be/qe60zwUAOqE\">Clojure Enemy of the State</a></li>\n<li><a href=\"https://github.com/MostlyAdequate/mostly-adequate-guide\">Professor Frisby’s Mostly Adequate Guide to Functional Programming</a></li>\n<li><a href=\"https://ramdajs.com/\">Ramda JS</a></li>\n</ul>","frontmatter":{"title":"How I write React code in 2021","date":"May 29, 2021"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/how-i-write-react-code-in-2021/","previous":{"excerpt":"Where to destructure props, and assign default values to them.","fields":{"slug":"/on-function-signatures/"},"frontmatter":{"title":"On function signatures"}},"next":{"excerpt":"Tools and processes.","fields":{"slug":"/on-design-systems-2/"},"frontmatter":{"title":"On design systems — 2"}}}}}